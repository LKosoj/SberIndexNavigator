"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è SberIndexNavigator.
–£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è, API –∫–ª—é—á–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
"""

import os
import logging
from typing import Optional
from dotenv import load_dotenv
from pathlib import Path

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env —Ñ–∞–π–ª–∞
load_dotenv()

logger = logging.getLogger(__name__)

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
DEBUG = os.getenv("DEBUG", "False").lower() == "true"

# OpenAI API Configuration
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
OPENAI_BASE_URL = os.getenv("OPENAI_BASE_URL")
OPENAI_MODEL = os.getenv("OPENAI_MODEL", "gpt-4.1-mini")
OPENAI_TEMPERATURE = float(os.getenv("OPENAI_TEMPERATURE", "0.1"))
OPENAI_MAX_TOKENS = int(os.getenv("OPENAI_MAX_TOKENS", "10000"))

# Database Configuration
DATABASE_URL = os.getenv("DATABASE_URL", "data/sber_index_prod.db")
MEMORY_DATABASE_URL = os.getenv("MEMORY_DATABASE_URL", "data/memory.db")

# Streamlit Configuration
STREAMLIT_SERVER_PORT = int(os.getenv("STREAMLIT_SERVER_PORT", "8501"))
STREAMLIT_THEME_BASE = os.getenv("STREAMLIT_THEME_BASE", "light")

# Cache Settings
CACHE_TTL = int(os.getenv("CACHE_TTL", "3600").split('#')[0].strip())  # 1 —á–∞—Å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
APP_TITLE = "üß≠ SberIndexNavigator"
APP_SUBTITLE = "–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä –ø–æ –¥–∞–Ω–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–≤ –°–±–µ—Ä–±–∞–Ω–∫–∞"

# –î–µ–º–æ —Å—Ü–µ–Ω–∞—Ä–∏–∏
DEMO_QUESTIONS = [
    # –ë–∞–∑–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    "–ì–¥–µ —Å–∞–º—ã–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—ã –ø–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏?",
    "–ö–∞–∫–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—ã –∏–º–µ—é—Ç —Å–∞–º—ã–µ –≤—ã—Å–æ–∫–∏–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã?",
    
    # –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã
    "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É –¥–æ—Ö–æ–¥–∞–º–∏ –∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏",
    "–ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è—é—Ç –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞—Ö?",
    "–°—Ä–∞–≤–Ω–∏ –ª–∏–¥–µ—Ä–æ–≤ –∏ –∞—É—Ç—Å–∞–π–¥–µ—Ä–æ–≤ –ø–æ –∏–Ω–¥–µ–∫—Å—É –∂–∏–ª—å—è",
    "–ü—Ä–µ–¥—Å–∫–∞–∂–∏ —Ç—Ä–µ–Ω–¥—ã —Ä–∞–∑–≤–∏—Ç–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
    
    # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã  
    "–î–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –≤ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞—Ö",
    "–ö–∞–∫–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –Ω—É–∂–Ω—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∂–∏–∑–Ω–∏?"
]

# –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
ANALYSIS_MODES = {
    "auto": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Ç–∏–ø–∞ –∞–Ω–∞–ª–∏–∑–∞",
    "basic": "–ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –≤—ã–≤–æ–¥–∞–º–∏", 
    "advanced": "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π"
}

# –¢–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
ANALYSIS_KEYWORDS = {
    "descriptive": [
        "–∞–Ω–∞–ª–∏–∑", "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "–æ–ø–∏—Å–∞–Ω–∏–µ", "–æ–±–∑–æ—Ä", "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞",
        "–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏", "–¥–∞–Ω–Ω—ã–µ", "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "overview", "summary"
    ],
    "comparative": [
        "—Å—Ä–∞–≤–Ω–∏", "–ª—É—á—à–µ", "—Ö—É–∂–µ", "–ª–∏–¥–µ—Ä", "–∞—É—Ç—Å–∞–π–¥–µ—Ä", "—Ä–∞–∑–ª–∏—á–∏—è", 
        "—Ç–æ–ø", "—Ä–µ–π—Ç–∏–Ω–≥", "compare", "difference", "best", "worst"
    ],
    "correlation": [
        "–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è", "—Å–≤—è–∑—å", "–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å", "–≤–ª–∏—è–Ω–∏–µ", "–≤–∑–∞–∏–º–æ—Å–≤—è–∑—å",
        "relationship", "correlation", "dependency", "impact", "affect"
    ],
    "forecasting": [
        "–ø—Ä–æ–≥–Ω–æ–∑", "—Ç—Ä–µ–Ω–¥", "–±—É–¥—É—â–µ–µ", "–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å", "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",
        "forecast", "predict", "trend", "future", "projection"
    ]
}

# –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–æ–±–∞–≤–ª–µ–Ω—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º)
ANALYSIS_PROMPT_TEMPLATES = {
    "recommendation_prompt": """
–û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –°–±–µ—Ä–±–∞–Ω–∫–∞, —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π 
–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è:

1. –û—Ä–≥–∞–Ω–æ–≤ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –ú–µ—Å—Ç–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–π  
3. –ò–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ –∏ –±–∏–∑–Ω–µ—Å–∞
4. –°–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–ª—É–∂–±

–£—á–∏—Ç—ã–≤–∞–π:
- –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –†–µ—Å—É—Ä—Å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –°–æ—Ü–∏–∞–ª—å–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç—å –º–µ—Ä

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º–∏
- –û–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –†–µ–∞–ª–∏–∑—É–µ–º—ã–º–∏ –≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –∏ —Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ
""",

    "insight_extraction_prompt": """
–ò–∑–≤–ª–µ–∫–∏ –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

1. –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º
2. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è  
3. –°–∫—Ä—ã—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è
4. –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏

–§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞:
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º –≤–ª–∏—è–Ω–∏–∏ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–∏—Ç—É–∞—Ü–∏–∏
""",

    "risk_assessment_prompt": """
–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏:

1. –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ (—Å–Ω–∏–∂–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤, —Ä–æ—Å—Ç –±–µ–∑—Ä–∞–±–æ—Ç–∏—Ü—ã)
2. –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏ (—É—Ö—É–¥—à–µ–Ω–∏–µ –¥–µ–º–æ–≥—Ä–∞—Ñ–∏–∏, –º–∏–≥—Ä–∞—Ü–∏—è)
3. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ä–∏—Å–∫–∏ (–∏–∑–Ω–æ—Å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞, –∂–∏–ª—å—è)
4. –ú—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–µ –¥–∏—Å–ø—Ä–æ–ø–æ—Ä—Ü–∏–∏

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∏—Å–∫–∞ —É–∫–∞–∂–∏:
- –£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ (–≤—ã—Å–æ–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/–Ω–∏–∑–∫–∏–π)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è
- –ú–µ—Ä—ã –ø–æ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏
"""
}

# –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
SQL_AGENT_SYSTEM_PROMPT = """
–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π SQL-–∞–Ω–∞–ª–∏—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –°–±–µ—Ä–±–∞–Ω–∫–∞ —Å–æ –∑–Ω–∞–Ω–∏–µ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ SQL DuckDB –∏ –∑–Ω–∞–Ω–∏–µ–º —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞–≤–∞—Ç—å –£–ú–ù–´–ï –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–∂–∏–º–∞—é—Ç –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –¥–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π —Å—É—Ç–∏.

=== –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ï –ü–†–ò–ù–¶–ò–ü–´ –ê–ù–ê–õ–ò–ó–ê ===

üß† –ê–ù–ê–õ–ò–ó–ò–†–£–ô –ü–ï–†–ï–î –ì–ï–ù–ï–†–ê–¶–ò–ï–ô:
1. –û–ø—Ä–µ–¥–µ–ª–∏, –∫–∞–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω—É–∂–Ω—ã –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å
2. –ù–∞–π–¥–∏ —Ç–∞–±–ª–∏—Ü—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —ç—Ç–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏  
3. –ü—Ä–æ–≤–µ—Ä—å, –µ—Å—Ç—å –ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ (year, month, date) –≤ –Ω—É–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
4. –í—ã–±–µ—Ä–∏ –ø–æ–¥—Ö–æ–¥—è—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
5. –ü—Ä–∏–º–µ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ SQL

‚ö° –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ò–õ–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò:

üî• –î–õ–Ø –°–õ–û–ñ–ù–´–• –ú–ù–û–ì–û–¢–ê–ë–õ–ò–ß–ù–´–• –ó–ê–ü–†–û–°–û–í (>2 —Ç–∞–±–ª–∏—Ü):
–ü–†–û–ë–õ–ï–ú–ê: Multiple LEFT JOIN –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü = –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!
–†–ï–®–ï–ù–ò–ï: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π CTE (Common Table Expressions) —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π

‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
```sql
SELECT AVG(t1.metric1), AVG(t2.metric2), AVG(t3.metric3)
FROM huge_table1 t1 
LEFT JOIN huge_table2 t2 ON t1.territory_id = t2.territory_id
LEFT JOIN huge_table3 t3 ON t1.territory_id = t3.territory_id
GROUP BY t1.region
```

‚úÖ –í–°–ï–ì–î–ê –î–ï–õ–ê–ô –¢–ê–ö:
```sql
WITH agg1 AS (
    SELECT territory_id, region, AVG(metric1) as avg_metric1
    FROM huge_table1 WHERE metric1 IS NOT NULL
    GROUP BY territory_id, region
),
agg2 AS (
    SELECT territory_id, AVG(metric2) as avg_metric2
    FROM huge_table2 WHERE metric2 IS NOT NULL
    GROUP BY territory_id
)
SELECT a1.region, a1.avg_metric1, COALESCE(a2.avg_metric2, 0)
FROM agg1 a1
LEFT JOIN agg2 a2 ON a1.territory_id = a2.territory_id
```

üìä –†–ê–ó–ú–ï–†–´ –¢–ê–ë–õ–ò–¶ (—É—á–∏—Ç—ã–≤–∞–π –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏):
- employment_full: 587K –∑–∞–ø–∏—Å–µ–π (–ë–û–õ–¨–®–ê–Ø)
- retail_catering: 856K –∑–∞–ø–∏—Å–µ–π (–û–ì–†–û–ú–ù–ê–Ø) 
- bdmo_salary_full: 429K –∑–∞–ø–∏—Å–µ–π (–ë–û–õ–¨–®–ê–Ø)
- kom_sph: 2K –∑–∞–ø–∏—Å–µ–π (–º–∞–ª–µ–Ω—å–∫–∞—è)
- soc_people_quantity_payments_volume: 48K –∑–∞–ø–∏—Å–µ–π (—Å—Ä–µ–¥–Ω—è—è)

üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –ü–û –†–ê–ó–ú–ï–†–ê–ú:
- –ü—Ä–∏ JOIN 2+ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü (>100K) ‚Üí –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û CTE
- –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ ‚Üí –æ–±—ã—á–Ω—ã–π GROUP BY

üî∏ –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó ("—Å—Ä–∞–≤–Ω–∏", "–ª—É—á—à–µ", "—Ö—É–∂–µ", "–ª–∏–¥–µ—Ä—ã", "—Ç–æ–ø"):
–¶–ï–õ–¨: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
–¢–ï–•–ù–ò–ö–ò:
- GROUP BY region + –∞–≥—Ä–µ–≥–∞—Ç—ã (AVG, COUNT, STDDEV, MIN, MAX)
- RANK() / ROW_NUMBER() –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è  
- –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
–ü–†–ò–ú–ï–† –ü–ê–¢–¢–ï–†–ù–ê:
SELECT 
    {—Ç–∞–±–ª–∏—Ü–∞}.region,
    ROUND(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–æ—Å–Ω–æ–≤–Ω–∞—è_–º–µ—Ç—Ä–∏–∫–∞}), 2) as avg_value,
    COUNT(*) as data_points,
    RANK() OVER (ORDER BY AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–æ—Å–Ω–æ–≤–Ω–∞—è_–º–µ—Ç—Ä–∏–∫–∞}) DESC) as ranking,
    ROUND(100.0 * AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–æ—Å–Ω–æ–≤–Ω–∞—è_–º–µ—Ç—Ä–∏–∫–∞}) / (SELECT AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–æ—Å–Ω–æ–≤–Ω–∞—è_–º–µ—Ç—Ä–∏–∫–∞}) FROM {—Ç–∞–±–ª–∏—Ü–∞} WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–æ—Å–Ω–æ–≤–Ω–∞—è_–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL), 1) as vs_average_pct
FROM {—Ç–∞–±–ª–∏—Ü–∞}
WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–æ—Å–Ω–æ–≤–Ω–∞—è_–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL
GROUP BY {—Ç–∞–±–ª–∏—Ü–∞}.region
ORDER BY avg_value DESC
-- LIMIT {N} (–¥–æ–±–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç)

üî∏ –í–†–ï–ú–ï–ù–ù–û–ô –ê–ù–ê–õ–ò–ó ("–¥–∏–Ω–∞–º–∏–∫–∞", "—Ç—Ä–µ–Ω–¥", "–∏–∑–º–µ–Ω–µ–Ω–∏–µ", "–ø—Ä–æ–≥–Ω–æ–∑"):
–¶–ï–õ–¨: –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏
–ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏!

üïê –¢–ò–ü–´ –í–†–ï–ú–ï–ù–ù–´–• –ö–û–õ–û–ù–û–ö –í –°–•–ï–ú–ï:
1. **–ü—Ä–æ—Å—Ç—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏**: year, month, date
2. **–î–∏–∞–ø–∞–∑–æ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏**: year_from, year_to (–≤ —Ç–∞–±–ª–∏—Ü–∞—Ö: market_access_full, consumption_full, bdmo_*_full)
3. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ**: year + month

üîß –°–¢–†–ê–¢–ï–ì–ò–ò –û–ë–†–ê–ë–û–¢–ö–ò –í–†–ï–ú–ï–ù–ò:

**–í–ê–†–ò–ê–ù–¢ A: –¢–∞–±–ª–∏—Ü—ã —Å year_from/year_to (market_access_full, consumption_full, bdmo_*_full)**
```sql
-- –ò—Å–ø–æ–ª—å–∑—É–π year_to –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
SELECT 
    {—Ç–∞–±–ª–∏—Ü–∞}.region_name,
    {—Ç–∞–±–ª–∏—Ü–∞}.year_to as year,
    ROUND(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}), 2) as period_avg,
    COUNT(*) as record_count,
    LAG(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞})) OVER (PARTITION BY {—Ç–∞–±–ª–∏—Ü–∞}.region_name ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year_to) as prev_period,
    ROUND(100.0 * (AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}) - LAG(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞})) OVER (PARTITION BY {—Ç–∞–±–ª–∏—Ü–∞}.region_name ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year_to)) / 
          NULLIF(LAG(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞})) OVER (PARTITION BY {—Ç–∞–±–ª–∏—Ü–∞}.region_name ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year_to), 0), 2) as growth_rate_pct
FROM {—Ç–∞–±–ª–∏—Ü–∞}
WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL
GROUP BY {—Ç–∞–±–ª–∏—Ü–∞}.region_name, {—Ç–∞–±–ª–∏—Ü–∞}.year_to
ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.region_name, {—Ç–∞–±–ª–∏—Ü–∞}.year_to
```

**–í–ê–†–ò–ê–ù–¢ B: –¢–∞–±–ª–∏—Ü—ã —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ (year, month)**
```sql
SELECT 
    {—Ç–∞–±–ª–∏—Ü–∞}.year, {—Ç–∞–±–ª–∏—Ü–∞}.month,
    ROUND(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}), 2) as period_avg,
    COUNT(*) as record_count,
    LAG(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞})) OVER (ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year, {—Ç–∞–±–ª–∏—Ü–∞}.month) as prev_period,
    ROUND(100.0 * (AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}) - LAG(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞})) OVER (ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year, {—Ç–∞–±–ª–∏—Ü–∞}.month)) / 
          NULLIF(LAG(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞})) OVER (ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year, {—Ç–∞–±–ª–∏—Ü–∞}.month), 0), 2) as growth_rate_pct
FROM {—Ç–∞–±–ª–∏—Ü–∞}
WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL
GROUP BY {—Ç–∞–±–ª–∏—Ü–∞}.year, {—Ç–∞–±–ª–∏—Ü–∞}.month
ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.year, {—Ç–∞–±–ª–∏—Ü–∞}.month
```

‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
- –î–õ–Ø market_access_full, consumption_full, bdmo_*_full: –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π year_to (–ù–ï year!)
- –î–õ–Ø –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü: –∏—Å–ø–æ–ª—å–∑—É–π year –∏–ª–∏ month
- –í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∑–∞–ø—Ä–æ—Å–∞
- –ü—Ä–∏ –æ—à–∏–±–∫–µ "Referenced column 'year' not found" ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Å—è –Ω–∞ year_to/year_from

üî∏ –ö–û–†–†–ï–õ–Ø–¶–ò–û–ù–ù–´–ô –ê–ù–ê–õ–ò–ó ("—Å–≤—è–∑—å", "–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å", "–≤–ª–∏—è–Ω–∏–µ"):
–¶–ï–õ–¨: –í—ã—è–≤–ª–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
–¢–ï–•–ù–ò–ö–ò:
- JOIN —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ –æ–±—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ (region)
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (HAVING COUNT(*) >= N)
–ü–†–ò–ú–ï–† –ü–ê–¢–¢–ï–†–ù–ê:
SELECT 
    t1.region,
    ROUND(AVG(t1.{–º–µ—Ç—Ä–∏–∫–∞1}), 2) as avg_metric1,
    ROUND(AVG(t2.{–º–µ—Ç—Ä–∏–∫–∞2}), 2) as avg_metric2,
    ROUND(AVG(t1.{–º–µ—Ç—Ä–∏–∫–∞3}), 2) as avg_metric3,
    COUNT(*) as data_points
FROM {—Ç–∞–±–ª–∏—Ü–∞1} t1
JOIN {—Ç–∞–±–ª–∏—Ü–∞2} t2 ON t1.region = t2.region
WHERE t1.{–º–µ—Ç—Ä–∏–∫–∞1} IS NOT NULL AND t2.{–º–µ—Ç—Ä–∏–∫–∞2} IS NOT NULL
GROUP BY t1.region
HAVING COUNT(*) >= 3
ORDER BY avg_metric1 DESC
-- LIMIT 50 (–¥–æ–±–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç)

üî∏ –û–ü–ò–°–ê–¢–ï–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê ("–∞–Ω–∞–ª–∏–∑", "–æ–±–∑–æ—Ä", "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"):
–¶–ï–õ–¨: –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
–¢–ï–•–ù–ò–ö–ò:
- –î–µ—Å–∫—Ä–∏–ø—Ç–∏–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Å—Ä–µ–¥–Ω–µ–µ, –º–µ–¥–∏–∞–Ω–∞, –∫–≤–∞—Ä—Ç–∏–ª–∏)
- QUANTILE() –¥–ª—è –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–µ–π
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ UNION ALL
–ü–†–ò–ú–ï–† –ü–ê–¢–¢–ï–†–ù–ê:
SELECT 
    {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} as metric,
    COUNT(*) as total_records,
    ROUND(AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}), 2) as mean_val,
    ROUND(STDDEV({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}), 2) as std_dev,
    ROUND(MIN({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}), 2) as min_val,
    ROUND(QUANTILE({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}, 0.25), 2) as q1,
    ROUND(QUANTILE({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}, 0.5), 2) as median_val,
    ROUND(QUANTILE({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}, 0.75), 2) as q3,
    ROUND(MAX({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}), 2) as max_val
FROM {—Ç–∞–±–ª–∏—Ü–∞}
WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL

üî∏ –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó ("–≥–¥–µ", "–º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç", "—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"):
–¶–ï–õ–¨: –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
–¢–ï–•–ù–ò–ö–ò:
- –§–æ–∫—É—Å –Ω–∞ region –∫–∞–∫ –∫–ª—é—á–µ–≤–æ–º –∏–∑–º–µ—Ä–µ–Ω–∏–∏
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ CASE WHEN
- –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π
–ü–†–ò–ú–ï–† –ü–ê–¢–¢–ï–†–ù–ê:
SELECT 
    {—Ç–∞–±–ª–∏—Ü–∞}.region,
    ROUND({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}, 2) as value,
    RANK() OVER (ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} DESC) as regional_rank,
    CASE 
        WHEN {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} > (SELECT AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}) * 1.2 FROM {—Ç–∞–±–ª–∏—Ü–∞} WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL) THEN '–í—ã—Å–æ–∫–∏–π'
        WHEN {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} > (SELECT AVG({—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞}) * 0.8 FROM {—Ç–∞–±–ª–∏—Ü–∞} WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL) THEN '–°—Ä–µ–¥–Ω–∏–π'
        ELSE '–ù–∏–∑–∫–∏–π'
    END as performance_level
FROM {—Ç–∞–±–ª–∏—Ü–∞}
WHERE {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} IS NOT NULL
ORDER BY {—Ç–∞–±–ª–∏—Ü–∞}.{–º–µ—Ç—Ä–∏–∫–∞} DESC
-- LIMIT 30 (–¥–æ–±–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç)

=== –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –õ–û–ì–ò–ö–ê –í–´–ë–û–†–ê ===

üéØ –ê–õ–ì–û–†–ò–¢–ú –í–´–ë–û–†–ê –¢–ê–ë–õ–ò–¶–´ –ò –°–¢–†–ê–¢–ï–ì–ò–ò:
1. –û–ø—Ä–µ–¥–µ–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –≤ –≤–æ–ø—Ä–æ—Å–µ (—Ä–∞—Å—Ö–æ–¥—ã‚Üíconsumer_spending, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç‚Üítransport_accessibility/transport_score, –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—è‚Üípopulation)
2. –ù–∞–π–¥–∏ —Ç–∞–±–ª–∏—Ü—É —Å –Ω—É–∂–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
3. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
4. –í—ã–±–µ—Ä–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –∑–∞–ø—Ä–æ—Å–∞
5. –ê–¥–∞–ø—Ç–∏—Ä—É–π –ø–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –¥–∞–Ω–Ω—ã—Ö

–ü–†–ê–í–ò–õ–û: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–æ—Å–∏—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ù–ï –¥–æ–±–∞–≤–ª—è–π LIMIT –≤ SQL-–∑–∞–ø—Ä–æ—Å.

–ü–†–ê–í–ò–õ–ê –î–õ–Ø –¢–†–ê–ù–°–ü–û–†–¢–ù–´–• –î–ê–ù–ù–´–•:
- –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –¥–∏–Ω–∞–º–∏–∫–µ/—Ç—Ä–µ–Ω–¥–∞—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π transport_accessibility –∏–∑ region_spending (–µ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤ –ø–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π transport_score –∏–∑ transport_data
- –î–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ ‚Üí –æ–±—ä–µ–¥–∏–Ω–∏ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ JOIN –ø–æ region

‚è∞ –ü–†–ê–í–ò–õ–ê –î–õ–Ø –í–†–ï–ú–ï–ù–ù–´–• –î–ê–ù–ù–´–•:
**–¢–ê–ë–õ–ò–¶–´ –° year_from/year_to (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π year_to –≤–º–µ—Å—Ç–æ year):**
- market_access_full ‚Üí year_to –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–æ–≤
- consumption_full ‚Üí year_to –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è  
- bdmo_migration_full ‚Üí year_to –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤ –º–∏–≥—Ä–∞—Ü–∏–∏
- bdmo_population_full ‚Üí year_to –¥–ª—è –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- bdmo_salary_full ‚Üí year_to –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏ –∑–∞—Ä–ø–ª–∞—Ç
- connection_full ‚Üí year_to –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π

**–¢–ê–ë–õ–ò–¶–´ –° –æ–±—ã—á–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏:**
- region_spending ‚Üí year, month –¥–ª—è —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–µ–Ω–¥–æ–≤
- employment_full ‚Üí year –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
- retail_catering ‚Üí year –¥–ª—è —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏

üîÑ FALLBACK –°–¢–†–ê–¢–ï–ì–ò–ò:
- –ï—Å–ª–∏ –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç—Ä–µ–Ω–¥–∞ ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- –ï—Å–ª–∏ –º–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Å—Ç—É—é –≤—ã–±–æ—Ä–∫—É —Å ORDER BY + LIMIT (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç)
- –ï—Å–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è –∫–æ–ª–æ–Ω–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –≤—ã–±–µ—Ä–∏ –ø–æ—Ö–æ–∂—É—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
- –ï—Å–ª–∏ JOIN –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–µ–≥–∏–æ–Ω—É, –∞ –∑–∞—Ç–µ–º –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—É –∏ –æ–±—ä–µ–¥–∏–Ω–∏ —á–µ—Ä–µ–∑ UNION ALL)

üö® –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö –í–†–ï–ú–ï–ù–ù–´–• –ö–û–õ–û–ù–û–ö:
- –ü—Ä–∏ –æ—à–∏–±–∫–µ "Referenced column 'year' not found" ‚Üí –ø—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –Ω–∞–ª–∏—á–∏–µ year_from/year_to
- –ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å year_from/year_to ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π year_to –≤–º–µ—Å—Ç–æ year
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "Referenced column 'month' not found" ‚Üí —É–±–µ—Ä–∏ month –∏–∑ GROUP BY –∏ ORDER BY
- –î–ª—è —Ç–∞–±–ª–∏—Ü *_full –∏–∑ —Å—Ö–µ–º—ã sber_index ‚Üí –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π year_to –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

=== –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò ===

üöÄ –ò–ó–ë–ï–ì–ê–ô –ú–ï–î–õ–ï–ù–ù–´–• –ó–ê–ü–†–û–°–û–í:

‚ö° **–ü–†–û–ë–õ–ï–ú–ê: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ JOIN –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü**
‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
```sql
-- –ú–ï–î–õ–ï–ù–ù–û! –ö–∞—Ä—Ç–µ–∑–∏–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫
SELECT e.region_name, AVG(e.indicator_value), AVG(s.value)
FROM employment_full e                    -- 587K —Å—Ç—Ä–æ–∫ (225.8 –Ω–∞ territory_id)
LEFT JOIN bdmo_salary_full s ON e.territory_id = s.territory_id  -- 429K —Å—Ç—Ä–æ–∫ (164.0 –Ω–∞ territory_id)
LEFT JOIN organization_quantity o ON e.territory_id = o.territory_id
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 225.8 √ó 164.0 = 37,031 –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫–∞–∂–¥—ã–π territory_id!
```

‚úÖ –î–ï–õ–ê–ô –¢–ê–ö:
```sql
-- –ë–´–°–¢–†–û! –ò—Å–ø–æ–ª—å–∑—É–π —Å—É–±–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
SELECT 
    e.region_name,
    e.municipality,
    ROUND(AVG(e.indicator_value), 2) AS avg_employment,
    (SELECT ROUND(AVG(value), 2) FROM bdmo_salary_full s2 WHERE s2.territory_id = e.territory_id AND s2.value IS NOT NULL) AS avg_salary,
    (SELECT ROUND(AVG(market_access), 2) FROM market_access_full m2 WHERE m2.territory_id = e.territory_id) AS avg_market_access
FROM employment_full e
WHERE e.indicator_value IS NOT NULL
GROUP BY e.territory_id, e.region_name, e.municipality
```

üèóÔ∏è **–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê: CTE —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π**
```sql
WITH employment_agg AS (
    SELECT territory_id, region_name, ROUND(AVG(indicator_value), 2) AS avg_employment
    FROM employment_full WHERE indicator_value IS NOT NULL GROUP BY territory_id, region_name
),
salary_agg AS (
    SELECT territory_id, ROUND(AVG(value), 2) AS avg_salary
    FROM bdmo_salary_full WHERE value IS NOT NULL GROUP BY territory_id
)
SELECT e.region_name, e.avg_employment, COALESCE(s.avg_salary, 0) AS avg_salary
FROM employment_agg e
LEFT JOIN salary_agg s ON e.territory_id = s.territory_id
```

üìä **–†–ê–ó–ú–ï–†–´ –¢–ê–ë–õ–ò–¶ (–¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤):**
- employment_full: 587,822 —Å—Ç—Ä–æ–∫ (225.8 –∑–∞–ø–∏—Å–µ–π –Ω–∞ territory_id)
- bdmo_salary_full: 429,202 —Å—Ç—Ä–æ–∫ (164.0 –∑–∞–ø–∏—Å–µ–π –Ω–∞ territory_id) 
- organization_quantity: 35,473 —Å—Ç—Ä–æ–∫
- production_quantity: 75,872 —Å—Ç—Ä–æ–∫
- market_access_full: 3,101 —Å—Ç—Ä–æ–∫ (1 –∑–∞–ø–∏—Å—å –Ω–∞ territory_id)
- dict_municipal_districts: 3,101 —Å—Ç—Ä–æ–∫ (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)

‚ö†Ô∏è **–û–ü–ê–°–ù–´–ï –ö–û–ú–ë–ò–ù–ê–¶–ò–ò (–∏–∑–±–µ–≥–∞–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö JOIN):**
- employment_full + bdmo_salary_full = –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ 37K+ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –Ω–∞ territory_id
- employment_full + organization_quantity + production_quantity = –æ–≥—Ä–æ–º–Ω–æ–µ –∫–∞—Ä—Ç–µ–∑–∏–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ

‚úÖ **–ë–ï–ó–û–ü–ê–°–ù–´–ï –°–¢–†–ê–¢–ï–ì–ò–ò:**
1. **–°—É–±–∑–∞–ø—Ä–æ—Å—ã**: `(SELECT AVG(column) FROM table2 WHERE table2.territory_id = main.territory_id)`
2. **CTE –∞–≥—Ä–µ–≥–∞—Ü–∏—è**: —Å–Ω–∞—á–∞–ª–∞ GROUP BY, –ø–æ—Ç–æ–º JOIN –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. **–û–¥–∏–Ω–æ—á–Ω—ã–µ JOIN**: —Ç–æ–ª—å–∫–æ —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ (dict_municipal_districts, market_access_full)
4. **LIMIT –≤ —Å—É–±–∑–∞–ø—Ä–æ—Å–∞—Ö**: –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –≤—ã–±–æ—Ä–∫–∞, –Ω–µ –∞–≥—Ä–µ–≥–∞—Ü–∏—è

üéØ **–ü–†–ò–ù–¶–ò–ü–´ –í–´–ë–û–†–ê –°–¢–†–ê–¢–ï–ì–ò–ò:**
- ‚â§3 —Ç–∞–±–ª–∏—Ü—ã + –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∞—è ‚Üí –æ–±—ã—á–Ω—ã–π JOIN
- ‚â•3 –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü—ã ‚Üí —Å—É–±–∑–∞–ø—Ä–æ—Å—ã –∏–ª–∏ CTE
- –ù—É–∂–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Üí JOIN —Ç–æ–ª—å–∫–æ —Å dict_municipal_districts –≤ –∫–æ–Ω—Ü–µ
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ territory_id ‚Üí –í–°–ï–ì–î–ê –≥—Ä—É–ø–ø–∏—Ä—É–π –ø–æ territory_id –ø–µ—Ä–≤—ã–º

üìã **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ü–†–ê–í–ò–õ–¨–ù–´–ï –ò–ú–ï–ù–ê –ö–û–õ–û–ù–û–ö**

‚ö†Ô∏è **–†–ê–ó–ù–´–ï –¢–ê–ë–õ–ò–¶–´ –ò–°–ü–û–õ–¨–ó–£–Æ–¢ –†–ê–ó–ù–´–ï –ò–ú–ï–ù–ê –î–õ–Ø –ú–£–ù–ò–¶–ò–ü–ê–õ–ò–¢–ï–¢–û–í:**

üè¢ **–¢–ê–ë–õ–ò–¶–´ –° –ö–û–õ–û–ù–ö–û–ô `municipality`:**
- `employment_full` ‚Üí municipality, region_name
- `organization_quantity` ‚Üí municipality, region_name  
- `production_quantity` ‚Üí municipality, region_name
- `retail_catering` ‚Üí municipality, region_name
- `kom_sph` ‚Üí municipality, region_name
- `selhoz` ‚Üí municipality, region_name
- `selhoz_territory` ‚Üí municipality, region_name
- `soc_people_quantity_payments_volume` ‚Üí municipality, region_name

üèõÔ∏è **–¢–ê–ë–õ–ò–¶–´ –° –ö–û–õ–û–ù–ö–û–ô `municipal_district_name`:**
- `market_access_full` ‚Üí municipal_district_name, region_name
- `bdmo_salary_full` ‚Üí municipal_district_name, region_name
- `bdmo_population_full` ‚Üí municipal_district_name, region_name
- `bdmo_migration_full` ‚Üí municipal_district_name, region_name
- `consumption_full` ‚Üí municipal_district_name, region_name
- `connection_full` ‚Üí municipal_district_name_x/y, region_name_x/y
- `dict_municipal_districts` ‚Üí municipal_district_name, region_name
- `t_dict_municipal_districts_poly_full` ‚Üí municipal_district_name, region_name

üîÑ **–ü–†–ê–í–ò–õ–û –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ô –ö–û–†–†–ï–ö–¶–ò–ò:**
```sql
-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û –¥–ª—è market_access_full:
SELECT m.municipality FROM market_access_full m

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û –¥–ª—è market_access_full:
SELECT m.municipal_district_name AS municipality FROM market_access_full m

-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û –¥–ª—è employment_full:
SELECT e.municipal_district_name FROM employment_full e

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û –¥–ª—è employment_full:
SELECT e.municipality FROM employment_full e
```

üõ†Ô∏è **–°–¢–†–ê–¢–ï–ì–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –û–®–ò–ë–û–ö:**
1. –ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—à—å –æ—à–∏–±–∫—É "does not have a column named 'municipality'" ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `municipal_district_name`
2. –ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—à—å –æ—à–∏–±–∫—É "does not have a column named 'municipal_district_name'" ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `municipality`
3. –í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∑–∞–ø—Ä–æ—Å–∞
4. –ò—Å–ø–æ–ª—å–∑—É–π –∞–ª–∏–∞—Å—ã –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏: `municipal_district_name AS municipality`

=== –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ï –ü–†–ê–í–ò–õ–ê ===
1. –í–°–ï–ì–î–ê –Ω–∞—á–∏–Ω–∞–π —Å –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å—Ö–µ–º–µ
2. –§–∏–ª—å—Ç—Ä—É–π NULL: WHERE column IS NOT NULL –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
3. –ò—Å–ø–æ–ª—å–∑—É–π ROUND(value, 2) –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ —á–∏—Å–µ–ª
4. –î–æ–±–∞–≤–ª—è–π ORDER BY –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ (–Ω–æ –Ω–µ –ø–µ—Ä–µ–¥ UNION –∏–ª–∏ UNION ALL)
5. –ó–∞—â–∏—â–∞–π—Å—è –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å: NULLIF(divisor, 0)
6. –ü—Ä–∏–º–µ–Ω—è–π –ø–æ–Ω—è—Ç–Ω—ã–µ –∞–ª–∏–∞—Å—ã: avg_spending –≤–º–µ—Å—Ç–æ AVG_spending
7. –î–ª—è –∫–≤–∞—Ä—Ç–∏–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π QUANTILE(column, 0.25) (DuckDB)
8. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤–º–µ—Å—Ç–µ —Å –∏–º–µ–Ω–µ–º –∫–æ–ª–æ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: table_name.column_name

=== –ê–ù–¢–ò-–ü–ê–¢–¢–ï–†–ù–´ ===
‚ùå SELECT * FROM table -- –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–ª–æ–Ω–æ–∫ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
‚ùå –ê–≥—Ä–µ–≥–∞—Ü–∏—è –±–µ–∑ GROUP BY –∫–æ–≥–¥–∞ –æ–Ω–∞ –Ω—É–∂–Ω–∞
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ NULL –∑–Ω–∞—á–µ–Ω–∏–π
‚ùå –î–µ–ª–µ–Ω–∏–µ –±–µ–∑ –∑–∞—â–∏—Ç—ã –æ—Ç –Ω—É–ª—è
‚ùå –ù–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
‚ùå ORDER BY –ø–µ—Ä–µ–¥ UNION –∏–ª–∏ UNION ALL
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ year –≤–º–µ—Å—Ç–æ year_to –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Å –¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ê–ù–¢–ò-–ü–ê–¢–¢–ï–†–ù–´ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò:**
‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ JOIN –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü (employment_full + bdmo_salary_full + ...)
‚ùå LEFT JOIN –±–µ–∑ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ ‚Üí –∫–∞—Ä—Ç–µ–∑–∏–∞–Ω—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
‚ùå GROUP BY –ø–æ—Å–ª–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö JOIN (–∞–≥—Ä–µ–≥–∞—Ü–∏—è –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫)
‚ùå JOIN –±–µ–∑ —É—á–µ—Ç–∞ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü (–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫–ª—é—á)

üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ê–ù–¢–ò-–ü–ê–¢–¢–ï–†–ù–´ –ò–ú–ï–ù –ö–û–õ–û–ù–û–ö:**
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `municipality` –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Å `municipal_district_name` (market_access_full, bdmo_*_full)
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `municipal_district_name` –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Å `municipality` (employment_full, organization_quantity)
‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–ª–∏–∞—Å–æ–≤ –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–º–µ–Ω –∫–æ–ª–æ–Ω–æ–∫

üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ê–ù–¢–ò-–ü–ê–¢–¢–ï–†–ù–´ –ö–û–û–†–î–ò–ù–ê–¢:**
‚ùå GROUP BY –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º –±–µ–∑ –≤–∫–ª—é—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ SELECT
‚ùå JOIN + GROUP BY –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–∫–æ–≥–¥–∞ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏)
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ `IS NOT NULL` –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–∏—Å–∫–ª—é—á–∞–µ—Ç –≤–∞–∂–Ω—ã–µ –≥–æ—Ä–æ–¥–∞)
‚ùå –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –±–µ–∑ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤ GROUP BY –∑–∞–ø—Ä–æ—Å–∞—Ö
‚ùå –í–∑—è—Ç–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (kom_sph, employment_full, organization_quantity –∏ –¥—Ä.)
‚ùå –ó–ê–ë–´–í–ê–¢–¨ –¥–æ–±–∞–≤–∏—Ç—å JOIN —Å dict_municipal_districts –∫–æ–≥–¥–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ê–ù–¢–ò-–ü–ê–¢–¢–ï–†–ù–´ –ü–û–ò–°–ö–ê –ì–û–†–û–î–û–í:**
‚ùå –ü–æ–∏—Å–∫ –ú–æ—Å–∫–≤—ã/–°–ü–± –≤ municipality –≤–º–µ—Å—Ç–æ region_name (–ú–æ—Å–∫–≤–∞ ‚Üí region_name = '–ú–æ—Å–∫–≤–∞'!)
‚ùå –ü–æ–∏—Å–∫ –æ–±—ã—á–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ region_name –≤–º–µ—Å—Ç–æ municipality (–ö–∞–∑–∞–Ω—å ‚Üí municipality LIKE '%–ö–∞–∑–∞–Ω—å%')
‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Ç–æ—á–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π (–ö–∞–∑–∞–Ω—å –≤–º–µ—Å—Ç–æ "–ì–æ—Ä–æ–¥ –ö–∞–∑–∞–Ω—å")
‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
‚ùå –ù–µ–∑–Ω–∞–Ω–∏–µ —á—Ç–æ –≥–æ—Ä–æ–¥–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è = —Ä–µ–≥–∏–æ–Ω—ã, –∞ –Ω–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—ã

=== –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –í–ö–õ–Æ–ß–ï–ù–ò–ï –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–• –ö–û–û–†–î–ò–ù–ê–¢ ===

üó∫Ô∏è –ü–†–ê–í–ò–õ–û –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–• –î–ê–ù–ù–´–•:
–ï–°–õ–ò –∑–∞–ø—Ä–æ—Å –∫–∞—Å–∞–µ—Ç—Å—è –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤/—Ä–µ–≥–∏–æ–Ω–æ–≤ –ò –ù–ï —è–≤–ª—è–µ—Ç—Å—è –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π (GROUP BY region):
–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∞–π –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ SELECT!

üîç –°–¢–†–ê–¢–ï–ì–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –ö–û–û–†–î–ò–ù–ê–¢:

1Ô∏è‚É£ **–ü–†–û–í–ï–†–¨ –ù–ê–õ–ò–ß–ò–ï –ö–û–û–†–î–ò–ù–ê–¢ –í –û–°–ù–û–í–ù–û–ô –¢–ê–ë–õ–ò–¶–ï:**
–ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –∫–æ–ª–æ–Ω–∫–∏ municipal_district_center_lat –∏ municipal_district_center_lon:
```sql
SELECT 
    main_table.municipality,
    main_table.region_name, 
    main_table.indicator_value,
    main_table.municipal_district_center_lat as lat,
    main_table.municipal_district_center_lon as lon
FROM main_table
```

2Ô∏è‚É£ **–ï–°–õ–ò –ö–û–û–†–î–ò–ù–ê–¢ –ù–ï–¢ - –ò–°–ü–û–õ–¨–ó–£–ô JOIN:**
–ï—Å–ª–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –ù–ï–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ JOIN —Å dict_municipal_districts:
```sql
SELECT 
    main_table.municipality,
    main_table.region_name,
    main_table.indicator_value,
    coords.municipal_district_center_lat as lat,
    coords.municipal_district_center_lon as lon
FROM main_table
JOIN dict_municipal_districts coords ON main_table.territory_id = coords.territory_id
```

üéØ –ü–†–ò–ú–ï–ù–ï–ù–ò–ï:
‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∞–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ö–û–ì–î–ê:
- –ó–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º
- –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–≥–æ–¥–Ω—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ
- GROUP BY –ø–æ municipality/municipal_district_name (–ù–ï —Ç–æ–ª—å–∫–æ –ø–æ region!)

‚ùå –ù–ï –≤–∫–ª—é—á–∞–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ö–û–ì–î–ê:
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã (GROUP BY year/month)
- –¢–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–¥–∫–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (GROUP BY region_name –±–µ–∑ municipality)
- –û–±—â–∏–µ –∞–≥—Ä–µ–≥–∞—Ç—ã –±–µ–∑ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞

üîß **–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ü–†–ê–í–ò–õ–ê –î–õ–Ø GROUP BY –ó–ê–ü–†–û–°–û–í:**

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û - —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏:**
```sql
-- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º ‚Üí –í–ö–õ–Æ–ß–ê–ô –ö–û–û–†–î–ò–ù–ê–¢–´
SELECT region_name, municipal_district_name AS municipality,
       AVG(value) AS avg_value,
       -- ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤–ª—è–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:
       AVG(municipal_district_center_lat) AS lat,
       AVG(municipal_district_center_lon) AS lon
FROM table_name 
WHERE municipal_district_center_lat IS NOT NULL 
GROUP BY region_name, municipal_district_name
```

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**
```sql
-- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí –ù–ï –î–ï–õ–ê–ô –¢–ê–ö!
SELECT region_name, municipal_district_name AS municipality,
       AVG(value) AS avg_value
-- ‚ùå –ü–†–û–ü–£–©–ï–ù–´ –ö–û–û–†–î–ò–ù–ê–¢–´!
FROM table_name 
GROUP BY region_name, municipal_district_name
```

‚ö†Ô∏è **–í–ê–ñ–ù–û: –û–±—Ä–∞–±–æ—Ç–∫–∞ NULL –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**
- –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ñ–∏–ª—å—Ç—Ä IS NOT NULL –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç - –ø—É—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –¥–∞–∂–µ –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- –ì–æ—Ä–æ–¥–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (–ú–æ—Å–∫–≤–∞, –°–ü–±) –∏–º–µ—é—Ç NULL –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –Ω–æ –¥–∞–Ω–Ω—ã–µ –≤–∞–∂–Ω—ã
- –ò—Å–ø–æ–ª—å–∑—É–π `AVG()` –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø—Ä–∏ GROUP BY: `AVG(municipal_district_center_lat) AS lat`
- NULL –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∞—é—Ç—Å—è –≤ –∫–æ–¥–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã

üîó **–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ü–†–ê–í–ò–õ–ê –î–õ–Ø JOIN + GROUP BY + –ö–û–û–†–î–ò–ù–ê–¢–´:**

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ JOIN –∑–∞–ø—Ä–æ—Å–∞—Ö:**
```sql
-- –°–ª—É—á–∞–π 1: –û–¥–Ω–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü –∏–º–µ–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
SELECT s.region_name, s.municipal_district_name AS municipality,
       ROUND(AVG(s.value), 2) AS avg_salary,
       ROUND(AVG(c.value), 2) AS avg_consumption,
       -- ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏:
       AVG(s.municipal_district_center_lat) AS lat,
       AVG(s.municipal_district_center_lon) AS lon
FROM bdmo_salary_full s  -- —ç—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –ò–ú–ï–ï–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
JOIN consumption_full c ON s.territory_id = c.territory_id
WHERE s.value IS NOT NULL AND c.value IS NOT NULL
  -- ‚úÖ –ù–ï —Ñ–∏–ª—å—Ç—Ä—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã - –ø—É—Å—Ç—å –±—É–¥—É—Ç NULL –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤ –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
GROUP BY s.region_name, s.municipal_district_name

-- –°–ª—É—á–∞–π 2: –û–±–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–µ—é—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã - –≤—ã–±–µ—Ä–∏ –æ–¥–Ω—É
SELECT e.region_name, e.municipality,
       ROUND(AVG(e.indicator_value), 2) AS avg_employment,
       ROUND(AVG(m.market_access), 2) AS avg_market_access,
       -- ‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–ª—é–±–æ–π):
       AVG(e.lat) AS lat, AVG(e.lon) AS lon
FROM employment_full e
JOIN market_access_full m ON e.territory_id = m.territory_id
-- ‚úÖ –ù–ï —Ñ–∏–ª—å—Ç—Ä—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã - –¥–∞–Ω–Ω—ã–µ –≤–∞–∂–Ω–µ–µ –∫–∞—Ä—Ç—ã
GROUP BY e.region_name, e.municipality
```

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**
```sql
-- ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö - kom_sph –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç!
SELECT k.municipality, k.indicator_value,
       AVG(k.municipal_district_center_lat) AS lat  -- ‚ùå –û–®–ò–ë–ö–ê! –£ kom_sph –ù–ï–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç!
FROM kom_sph k

-- ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö - soc_people_quantity_payments_volume –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç!
SELECT s.municipality, s.indicator_value,
       AVG(s.municipal_district_center_lat) AS lat  -- ‚ùå –û–®–ò–ë–ö–ê! –£ —Ç–∞–±–ª–∏—Ü—ã s –Ω–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç!
FROM soc_people_quantity_payments_volume s

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –¥–æ–±–∞–≤–ª—è–µ–º JOIN –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:
SELECT k.municipality, k.indicator_value,
       AVG(d.municipal_district_center_lat) AS lat,  -- ‚úÖ –ë–µ—Ä–µ–º –∏–∑ dict_municipal_districts!
       AVG(d.municipal_district_center_lon) AS lon
FROM kom_sph k  -- –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
JOIN dict_municipal_districts d ON k.territory_id = d.territory_id  -- –î–æ–±–∞–≤–ª—è–µ–º –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç!
```

üéØ **–ê–õ–ì–û–†–ò–¢–ú –í–´–ë–û–†–ê –ò–°–¢–û–ß–ù–ò–ö–ê –ö–û–û–†–î–ò–ù–ê–¢:**

üìç **–¢–ê–ë–õ–ò–¶–´ –° –ö–û–û–†–î–ò–ù–ê–¢–ê–ú–ò (municipal_district_center_lat/lon):**
‚úÖ **–ò–ú–ï–Æ–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
- `bdmo_migration_full` ‚Üí bdmo_migration_full.municipal_district_center_lat/lon
- `bdmo_population_full` ‚Üí bdmo_population_full.municipal_district_center_lat/lon  
- `bdmo_salary_full` ‚Üí bdmo_salary_full.municipal_district_center_lat/lon
- `market_access_full` ‚Üí market_access_full.municipal_district_center_lat/lon
- `consumption_full` ‚Üí consumption_full.municipal_district_center_lat/lon
- `dict_municipal_districts` ‚Üí dict_municipal_districts.municipal_district_center_lat/lon
- `t_dict_municipal_districts_poly_full` ‚Üí t_dict_municipal_districts_poly_full.municipal_district_center_lat/lon

‚ùå **–ù–ï –ò–ú–ï–Æ–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å JOIN —Å dict_municipal_districts!):**
- `employment_full` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `organization_quantity` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts  
- `production_quantity` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `retail_catering` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `kom_sph` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `selhoz` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `selhoz_territory` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `soc_people_quantity_payments_volume` ‚Üí –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí JOIN dict_municipal_districts
- `connection_full` ‚Üí —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π —Å _x/_y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

üí° **–ü–†–û–°–¢–û–ï –ü–†–ê–í–ò–õ–û:**
–ï–°–õ–ò –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ù–ï –≤ —Å–ø–∏—Å–∫–µ ‚úÖ ‚Üí –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å `JOIN dict_municipal_districts d ON main.territory_id = d.territory_id`

üîß **–ü–†–ê–í–ò–õ–ê –í–´–ë–û–†–ê –ò–°–¢–û–ß–ù–ò–ö–ê:**
1. **–ü–†–û–í–ï–†–¨ –æ—Å–Ω–æ–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
   ```sql
   -- ‚úÖ –ï–°–õ–ò –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ò–ú–ï–ï–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:
   SELECT main.region_name, main.municipality,
          AVG(main.municipal_district_center_lat) AS lat,
          AVG(main.municipal_district_center_lon) AS lon
   FROM bdmo_salary_full main  -- –ò–ú–ï–ï–¢ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
   ```

2. **–ï–°–õ–ò –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å JOIN:**
   ```sql
   -- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - kom_sph –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, –¥–æ–±–∞–≤–ª—è–µ–º dict_municipal_districts
   SELECT k.region_name, k.municipality, k.indicator_value,
          AVG(d.municipal_district_center_lat) AS lat,
          AVG(d.municipal_district_center_lon) AS lon
   FROM kom_sph k  -- –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç!
   JOIN dict_municipal_districts d ON k.territory_id = d.territory_id  -- –î–æ–±–∞–≤–ª—è–µ–º –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
   ```

3. **–í —Å–ª–æ–∂–Ω—ã—Ö JOIN –Ω–∞–π–¥–∏ –ª—é–±—É—é —Ç–∞–±–ª–∏—Ü—É –° –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏:**
   ```sql
   -- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –±–µ—Ä–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ market_access_full
   SELECT s.municipality, s.indicator_value,
          AVG(m.municipal_district_center_lat) AS lat,
          AVG(m.municipal_district_center_lon) AS lon
   FROM soc_people_quantity_payments_volume s  -- –ë–ï–ó –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
   JOIN market_access_full m ON s.territory_id = m.territory_id  -- –° –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏!
   ```

3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏):**
   1. –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (–µ—Å–ª–∏ –∏–º–µ–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
   2. market_access_full
   3. dict_municipal_districts
   4. bdmo_*_full —Ç–∞–±–ª–∏—Ü—ã

üèôÔ∏è **–ü–†–ê–í–ò–õ–ê –ü–û–ò–°–ö–ê –ì–û–†–û–î–û–í –ò –ú–£–ù–ò–¶–ò–ü–ê–õ–ò–¢–ï–¢–û–í:**

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–´–ï –ü–ê–¢–¢–ï–†–ù–´ –ü–û–ò–°–ö–ê:**
```sql
-- –ü–æ–∏—Å–∫ –ì–û–†–û–î–û–í –§–ï–î–ï–†–ê–õ–¨–ù–û–ì–û –ó–ù–ê–ß–ï–ù–ò–Ø:
WHERE region_name = '–ú–æ—Å–∫–≤–∞'  -- –¥–ª—è –ú–æ—Å–∫–≤—ã
WHERE region_name = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥'  -- –¥–ª—è –°–ü–±

-- –ü–æ–∏—Å–∫ –û–ë–´–ß–ù–´–• –ì–û–†–û–î–û–í (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ö–∞–∑–∞–Ω—å):
WHERE municipality LIKE '%–ö–∞–∑–∞–Ω—å%'  -- –Ω–∞–π–¥–µ—Ç "–ì–æ—Ä–æ–¥ –ö–∞–∑–∞–Ω—å", "–ö–∞–∑–∞–Ω—å" –∏ —Ç.–¥.
WHERE municipality = '–ì–æ—Ä–æ–¥ –ö–∞–∑–∞–Ω—å'  -- —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ

-- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω—É:
WHERE region_name = '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω'  -- –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ
WHERE region_name LIKE '%–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω%'  -- –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π –ø–æ–∏—Å–∫

-- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –æ–±—ã—á–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤:
WHERE municipality LIKE '%–ö–∞–∑–∞–Ω—å%' AND region_name LIKE '%–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω%'
```

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –ü–ê–¢–¢–ï–†–ù–´:**
```sql
-- ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö - –ø–æ–∏—Å–∫ –ú–æ—Å–∫–≤—ã –≤ municipality:
WHERE municipality LIKE '%–ú–æ—Å–∫–≤–∞%'  -- –û–®–ò–ë–ö–ê! –ú–æ—Å–∫–≤–∞ —ç—Ç–æ region_name, –Ω–µ municipality!

-- ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö - –ø–æ–∏—Å–∫ –æ–±—ã—á–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –≤ region_name:
WHERE region_name LIKE '%–ö–∞–∑–∞–Ω—å%'  -- –û–®–ò–ë–ö–ê! –ö–∞–∑–∞–Ω—å —ç—Ç–æ municipality, –Ω–µ region

-- ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö - —Å–ª–∏—à–∫–æ–º —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–µ–∑ —É—á–µ—Ç–∞ –≤–∞—Ä–∏–∞—Ü–∏–π:
WHERE municipality = '–ö–∞–∑–∞–Ω—å'  -- –º–æ–∂–µ—Ç –Ω–µ –Ω–∞–π—Ç–∏ "–ì–æ—Ä–æ–¥ –ö–∞–∑–∞–Ω—å"
```

üóÇÔ∏è **–§–û–†–ú–ê–¢–´ –ù–ê–ó–í–ê–ù–ò–ô –ì–û–†–û–î–û–í:**
- **–ö—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞**: "–ì–æ—Ä–æ–¥ –ö–∞–∑–∞–Ω—å", "–ì–æ—Ä–æ–¥ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ì–æ—Ä–æ–¥ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫"  
- **–°—Ç–æ–ª–∏—Ü—ã —Ä–µ–≥–∏–æ–Ω–æ–≤**: —á–∞—Å—Ç–æ –∏–º–µ—é—Ç –ø—Ä–µ—Ñ–∏–∫—Å "–ì–æ—Ä–æ–¥"
- **–ü–æ–∏—Å–∫**: –∏—Å–ø–æ–ª—å–∑—É–π `LIKE '%–ù–∞–∑–≤–∞–Ω–∏–µ–ì–æ—Ä–æ–¥–∞%'` –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏
- **–†–µ–≥–∏–æ–Ω—ã**: "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω", "–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"

üîç **–ê–õ–ì–û–†–ò–¢–ú –ü–û–ò–°–ö–ê –ì–û–†–û–î–ê:**

üèôÔ∏è **–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –°–õ–£–ß–ê–ò - –ì–û–†–û–î–ê –§–ï–î–ï–†–ê–õ–¨–ù–û–ì–û –ó–ù–ê–ß–ï–ù–ò–Ø:**
- **–ú–æ—Å–∫–≤–∞** ‚Üí –∏—â–∏ `region_name = '–ú–æ—Å–∫–≤–∞'` (–ù–ï municipality!)
- **–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥** ‚Üí –∏—â–∏ `region_name = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥'` (–ù–ï municipality!)  
- **–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å** ‚Üí –∏—â–∏ `region_name = '–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å'` (–ù–ï municipality!)

üèòÔ∏è **–û–ë–´–ß–ù–´–ï –ì–û–†–û–î–ê:**
1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–ø–æ–º—è–Ω—É–ª –æ–±—ã—á–Ω—ã–π –≥–æ—Ä–æ–¥** ‚Üí –∏—â–∏ –≤ `municipality LIKE '%–ì–æ—Ä–æ–¥–ò–º—è%'`
2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–ø–æ–º—è–Ω—É–ª —Ä–µ–≥–∏–æ–Ω** ‚Üí –∏—â–∏ –≤ `region_name LIKE '%–†–µ–≥–∏–æ–Ω–ò–º—è%'`  
3. **–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π OR: `municipality LIKE '%–ù–∞–∑–≤–∞–Ω–∏–µ%' OR region_name LIKE '%–ù–∞–∑–≤–∞–Ω–∏–µ%'`
4. **–£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** ‚Üí –¥–æ–±–∞–≤—å AND —É—Å–ª–æ–≤–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

üìç –ü–†–ò–ú–ï–† —Å JOIN –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:
SELECT 
    k.municipality,
    k.region_name,
    ROUND(k.indicator_value, 2) as housing_index,
    d.municipal_district_center_lat as lat,
    d.municipal_district_center_lon as lon,
    RANK() OVER (ORDER BY k.indicator_value DESC) as rank_desc
FROM kom_sph k
JOIN dict_municipal_districts d ON k.territory_id = d.territory_id
WHERE k.indicator_name LIKE '%–∂–∏–ª—å–µ%' AND k.indicator_value IS NOT NULL

üìä –ü–†–ò–ú–ï–† –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–∞–≥—Ä–µ–≥–∞—Ü–∏—è):
SELECT 
    region_name,
    AVG(indicator_value) as avg_value,
    COUNT(*) as count
FROM kom_sph
GROUP BY region_name

üîó –¢–ê–ë–õ–ò–¶–´ –° –ö–û–û–†–î–ò–ù–ê–¢–ê–ú–ò –ù–ê–ü–†–Ø–ú–£–Æ:
- bdmo_migration_full, bdmo_population_full, bdmo_salary_full
- consumption_full, market_access_full  
- dict_municipal_districts, t_dict_municipal_districts_poly_full

üìã –¢–ê–ë–õ–ò–¶–´ –ë–ï–ó –ö–û–û–†–î–ò–ù–ê–¢ (–Ω—É–∂–µ–Ω JOIN):
- kom_sph, employment_full, retail_catering
- organization_quantity, production_quantity, selhoz, selhoz_territory

### –û–ü–ò–°–ê–ù–ò–ï –¢–ê–ë–õ–ò–¶

–†–æ–∑–Ω–∏—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ | retail_catering
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è,–ü–ª–æ—â–∞–¥—å —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∑–∞–ª–∞ –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏, –ü–ª–æ—â–∞–¥—å –∑–∞–ª–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –≤ –æ–±—ä–µ–∫—Ç–∞—Ö –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è, –ß–∏—Å–ª–æ –º–µ—Å—Ç –≤ –æ–±—ä–µ–∫—Ç–∞—Ö –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è, –ß–∏—Å–ª–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–µ—Å—Ç –Ω–∞ —Ä—ã–Ω–∫–∞—Ö, –ß–∏—Å–ª–æ —Ä—ã–Ω–∫–æ–≤, –ß–∏—Å–ª–æ —è—Ä–º–∞—Ä–æ–∫, –ß–∏—Å–ª–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–µ—Å—Ç –Ω–∞ —è—Ä–º–∞—Ä–∫–∞—Ö, –û–±–æ—Ä–æ—Ç —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –û–±–æ—Ä–æ—Ç –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞))
obroz - –í–∏–¥—ã –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è 
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–π)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–°–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ | selhoz_territory
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ü–æ—Å–µ–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∏ —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä (–≤–µ—Å–µ–Ω–Ω–µ–≥–æ —É—á–µ—Ç–∞))
kategor - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ö–æ–∑—è–π—Å—Ç–≤
kultur - –°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - –ø–ª–æ—â–∞–¥—å –≤ –≥–µ–∫—Ç–∞—Ä–∞—Ö
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–∞ –≥–æ–¥)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–°–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ | selhoz
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–í–Ω–µ—Å–µ–Ω–æ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö —É–¥–æ–±—Ä–µ–Ω–∏–π –ø–æ–¥ –ø–æ—Å–µ–≤—ã —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä –≤ —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö)
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - –≤–µ—Å —É–¥–æ–±—Ä–µ–Ω–∏–π –≤ —Ç–æ–Ω–Ω–∞—Ö
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–∞ –≥–æ–¥)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–ö–æ–º–º—É–Ω–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞ | kom_sph
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å –∂–∏–ª—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–∞—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤–æ–¥–æ–ø—Ä–æ–≤–æ–¥–æ–º, –≤–æ–¥–æ–æ—Ç–≤–µ–¥–µ–Ω–∏–µ–º (–∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π), –æ—Ç–æ–ø–ª–µ–Ω–∏–µ–º, –≥–æ—Ä—è—á–∏–º –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ–º, –≥–∞–∑–æ–º –∏–ª–∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–º–∏ –ø–ª–∏—Ç–∞–º–∏)
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - –ø–ª–æ—â–∞–¥—å –≤ —Ç—ã—Å—è—á–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç—Ä–æ–≤
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–∞ –≥–æ–¥)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è | soc_people_quantity_payments_volume
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–°—É–º–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–Ω—ã—Ö —Å—É–±—Å–∏–¥–∏–π –Ω–∞—Å–µ–ª–µ–Ω–∏—é –Ω–∞ –æ–ø–ª–∞—Ç—É –∂–∏–ª–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è –∏ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã—Ö —É—Å–ª—É–≥)
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - —Ä–∞–∑–º–µ—Ä –≤—ã–ø–ª–∞—Ç—ã * —Ç—ã—Å—è—á–∞ —Ä—É–±–ª–µ–π
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–ó–∞–Ω—è—Ç–æ—Å—Ç—å –∏ –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ | employment_full
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç–µ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π ‚Äî –≤—Å–µ–≥–æ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç–µ –∏–∑-–∑–∞ –Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏–∑ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –±—é–¥–∂–µ—Ç–∞ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç–µ –∏–∑-–∑–∞ –Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏–∑ –±—é–¥–∂–µ—Ç–æ–≤ —Å—É–±—ä–µ–∫—Ç–æ–≤ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç–µ –∏–∑-–∑–∞ –Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏–∑ –º–µ—Å—Ç–Ω—ã—Ö –±—é–¥–∂–µ—Ç–æ–≤ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –°—Ä–µ–¥–Ω–µ—Å–ø–∏—Å–æ—á–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –§–æ–Ω–¥ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –≤—Å–µ—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞))
okved2 - –í–∏–¥—ã —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –û–ö–í–≠–î-2
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - —Ä–∞–∑–º–µ—Ä –≤—ã–ø–ª–∞—Ç—ã * —Ç—ã—Å—è—á–∞ —Ä—É–±–ª–µ–π
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–Ω–∞ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π | production_quantity
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–û—Ç–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Ä–∞–±–æ—Ç –∏ —É—Å–ª—É–≥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–∏–ª–∞–º–∏ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), —Å—Ä–µ–¥–Ω—è—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–≤—ã—à–∞–µ—Ç 15 —á–µ–ª–æ–≤–µ–∫, –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –≤–∏–¥–∞–º —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –û—Ç–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Ä–∞–±–æ—Ç –∏ —É—Å–ª—É–≥ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–∏–ª–∞–º–∏ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞), –ü—Ä–æ–¥–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ (–±–µ–∑ —Å—É–±—ä–µ–∫—Ç–æ–≤ –º–∞–ª–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–∞))
okved2 - –í–∏–¥—ã —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –û–ö–í–≠–î-2
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - —Ä–∞–∑–º–µ—Ä –≤—ã–ø–ª–∞—Ç—ã * —Ç—ã—Å—è—á–∞ —Ä—É–±–ª–µ–π
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π | organization_quantity
indicator_section_code - –∫–æ–¥ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_section - —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_code - –∫–æ–¥ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
indicator_name - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ø–æ –¥–∞–Ω–Ω—ã–º –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π –ø–æ –¥–∞–Ω–Ω—ã–º –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
region_id - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
mun_level - —É—Ä–æ–≤–µ–Ω—å –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_district - –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω
municipality - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
mun_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
mun_type_oktmo - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ –û–ö–¢–ú–û
oktmo_stable - —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –û–ö–¢–ú–û
oktmo_history - –∏—Å—Ç–æ—Ä–∏—è –û–ö–¢–ú–û
oktmo_year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
oktmo_year_to - –≥–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –û–ö–¢–ú–û
year - –≥–æ–¥ –∫–æ–≥–¥–∞ —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ
indicator_value - —á–∏—Å–ª–æ –ª—é–¥–µ–π
indicator_unit - –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
indicator_period - –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–Ω–∞ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞)
comment - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–î–∞–Ω–Ω—ã–µ –æ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–º –æ–∫—Ä—É–≥–∞–º —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º –∏ –ø–æ–ª–∞–º | bdmo_migration_full
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
year - –≥–æ–¥
period - –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ –º–∏–≥—Ä–∞—Ü–∏—è
age - –≤–æ–∑—Ä–∞—Å—Ç –º–∏–≥—Ä–∞–Ω—Ç–æ–≤
gender - –ø–æ–ª
value - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞
source_nm - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ –æ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–º –æ–∫—Ä—É–≥–∞–º —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º –∏ –ø–æ–ª–∞–º | bdmo_population_full
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
year - –≥–æ–¥
period - –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç
age - –≤–æ–∑—Ä–∞—Å—Ç –∂–∏—Ç–µ–ª–µ–π
gender - –ø–æ–ª
value - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞
source_nm - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ –æ —Å—Ä–µ–¥–Ω–∏—Ö –ø–æ–ª—É–≥–æ–¥–æ–≤—ã—Ö –∑–∞—Ä–ø–ª–∞—Ç–∞—Ö –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–º –æ–∫—Ä—É–≥–∞–º —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º | bdmo_salary_full
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
year - –≥–æ–¥
period - –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç
okved_name - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–∞–º
okved_letter - –±—É–∫–≤–∞ –û–ö–í–≠–î
value - —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞
source_nm - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–º–∏ –æ–∫—Ä—É–≥–∞–º–∏ | connection_full
territory_id_x - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ –æ—Ç–∫—É–¥–∞
territory_id_y - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ –∫—É–¥–∞
distance - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
change_id_from_x - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞ (–¥–ª—è x)
change_id_to_x - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞ (–¥–ª—è x)
municipal_district_center_x - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è x)
municipal_district_center_lat_x - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è x)
municipal_district_center_lon_x - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è x)
municipal_district_name_x - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è x)
municipal_district_name_short_x - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è x)
municipal_district_status_x - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞ (–¥–ª—è x)
municipal_district_type_x - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è x)
oktmo_x - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞ (–¥–ª—è x)
region_code_x - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞ (–¥–ª—è x)
region_name_x - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ (–¥–ª—è x)
shape_x - —Ñ–æ—Ä–º–∞ (–¥–ª—è x)
shape_linked_oktmo_x - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã (–¥–ª—è x)
year_from_x - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ (–¥–ª—è x)
year_to_x - –≥–æ–¥ –∫–æ–Ω—Ü–∞ (–¥–ª—è x)
change_id_from_y - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞ (–¥–ª—è y)
change_id_to_y - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞ (–¥–ª—è y)
municipal_district_center_y - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è y)
municipal_district_center_lat_y - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è y)
municipal_district_center_lon_y - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è y)
municipal_district_name_y - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è y)
municipal_district_name_short_y - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è y)
municipal_district_status_y - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞ (–¥–ª—è y)
municipal_district_type_y - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–¥–ª—è y)
oktmo_y - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞ (–¥–ª—è y)
region_code_y - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞ (–¥–ª—è y)
region_name_y - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ (–¥–ª—è y)
shape_y - —Ñ–æ—Ä–º–∞ (–¥–ª—è y)
shape_linked_oktmo_y - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã (–¥–ª—è y)
year_from_y - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ (–¥–ª—è y)
year_to_y - –≥–æ–¥ –∫–æ–Ω—Ü–∞ (–¥–ª—è y)
source_nm - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–ì–µ–æ–º–µ—Ç—Ä–∏—è –ø–æ–ª–∏–≥–æ–Ω–æ–≤ | t_dict_municipal_districts_poly_full
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
source_rosstat - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –†–æ—Å—Å—Ç–∞—Ç
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
fid - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏
geom - –º—É–ª—å—Ç–∏–ø–æ–ª–∏–≥–æ–Ω –ø–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—É (–≥–µ–æ–º–µ—Ç—Ä–∏—è)
osm_ref - —Ä–µ—Ñ–µ—Ä–µ–Ω—Å OpenStreetMap
osm_vers - –≤–µ—Ä—Å–∏—è OpenStreetMap
territory_id_1 - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
year_from_1 - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥–æ–¥ –Ω–∞—á–∞–ª–∞
year_to_1 - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥–æ–¥ –∫–æ–Ω—Ü–∞
source_nm - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–ò–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞ | market_access_full
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—Å–µ–ª–µ–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞)
source_rosstat - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –†–æ—Å—Å—Ç–∞—Ç
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
territory_id_1 - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
market_access - –∏–Ω–¥–µ–∫—Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞

–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –æ—Ç sberindex | dict_municipal_districts
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
source_rosstat - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –†–æ—Å—Å—Ç–∞—Ç
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞

–û—Ç—á–µ—Ç –æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–∞—Ö | consumption_full
date - –ì–æ–¥ –∏ –º–µ—Å—è—Ü
territory_id - id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ —É sberindex
category - –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
value - –û—Ü–µ–Ω–∫–∞ —Å—Ä–µ–¥–Ω–∏—Ö –±–µ–∑–Ω–∞–ª–∏—á–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ –∂–∏—Ç–µ–ª–µ–π –ú–û –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–¥–µ–ª–µ–π –°–±–µ—Ä–ò–Ω–¥–µ–∫—Å–∞ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ä—É–±.)
__index_level_0__ - –∏–Ω–¥–µ–∫—Å —É—Ä–æ–≤–Ω—è
municipal_district_name_short - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
oktmo - —Å–∫–≤–æ–∑–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞
municipal_district_name - –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_type - —Ç–∏–ø –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_status - —Å—Ç–∞—Ç—É—Å —Å—É–±—ä–µ–∫—Ç–∞
shape - —Ñ–æ—Ä–º–∞
shape_linked_oktmo - —Å–≤—è–∑–∞–Ω–Ω—ã–π –û–ö–¢–ú–û —Ñ–æ—Ä–º—ã
municipal_district_center - —Ü–µ–Ω—Ç—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
source_rosstat - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –†–æ—Å—Å—Ç–∞—Ç
year_from - –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
year_to - –≥–æ–¥ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞
territory_id_1 - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π id –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
change_id_from - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–∫—É–¥–∞
change_id_to - id –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É–¥–∞
region_code - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
region_name - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
municipal_district_center_lat - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
municipal_district_center_lon - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞ 

"""

VISUALIZATION_TOOL_PROMPT = """
–û–ø—Ä–µ–¥–µ–ª–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ç–∏–ø –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö:

–ü—Ä–∞–≤–∏–ª–∞ –≤—ã–±–æ—Ä–∞:
- line: –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã, –¥–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- bar: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –º–µ–∂–¥—É –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏  
- scatter: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
- map: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- table: –î–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–æ–ø-—Å–ø–∏—Å–∫–∏

–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º: line, bar, scatter, map –∏–ª–∏ table.
"""

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
CHART_HEIGHT = 400
CHART_WIDTH = 800
MAP_DEFAULT_ZOOM = 3
MAP_CENTER_LAT = 61.5240
MAP_CENTER_LON = 105.3188

# –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
COLOR_PALETTE = [
    "#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd",
    "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"
]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
MAX_RETRIES = 12
API_TIMEOUT = 30
QUERY_TIMEOUT = 10

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–µ–º—ã
def create_streamlit_config() -> None:
    """
    –°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª .streamlit/config.toml –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π STREAMLIT_THEME_BASE.
    """
    # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é .streamlit –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    config_dir = Path(".streamlit")
    config_dir.mkdir(exist_ok=True)
    
    config_file = config_dir / "config.toml"
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–º—É –Ω–∞ –æ—Å–Ω–æ–≤–µ STREAMLIT_THEME_BASE
    if STREAMLIT_THEME_BASE.lower() == "dark":
        theme_config = """[theme]
base = "dark"
primaryColor = "#00C851"
backgroundColor = "#0F1419" 
secondaryBackgroundColor = "#1E2328"
textColor = "#FAFAFA"
font = "sans serif"
"""
    else:  # light theme (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        theme_config = """[theme]
base = "light"
primaryColor = "#1f77b4"
backgroundColor = "#FFFFFF"
secondaryBackgroundColor = "#F0F2F6"
textColor = "#262730"
font = "sans serif"
"""
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è
    if not config_file.exists() or config_file.read_text() != theme_config:
        config_file.write_text(theme_config)
        logger.info(f"–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–µ–º—ã: {config_file}")

# –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
def validate_config() -> bool:
    """
    –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    
    Returns:
        True –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω–∞, False –∏–Ω–∞—á–µ
    """
    errors = []
    
    if not OPENAI_API_KEY:
        errors.append("OPENAI_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—É—Ç—å —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é)
    db_dir = os.path.dirname(DATABASE_URL)
    if db_dir and not os.path.exists(db_dir):
        try:
            os.makedirs(db_dir, exist_ok=True)
        except Exception as e:
            errors.append(f"–ù–µ —É–¥–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ë–î: {e}")
    
    if errors:
        for error in errors:
            logging.error(error)
        return False
    
    return True


def setup_logging() -> None:
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è."""
    log_format = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    
    if DEBUG:
        level = logging.DEBUG
    else:
        level = getattr(logging, LOG_LEVEL.upper(), logging.INFO)
    
    logging.basicConfig(
        level=level,
        format=log_format,
        handlers=[
            logging.StreamHandler(),
            logging.FileHandler("logs/app.log") if os.path.exists("logs") or os.makedirs("logs", exist_ok=True) else logging.StreamHandler()
        ]
    )


# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
setup_logging()

if not validate_config():
    logging.warning("–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.") 


def get_openai_settings() -> dict:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ OpenAI –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.
    
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ OpenAI
    """
    return {
        'api_key': OPENAI_API_KEY,
        'base_url': OPENAI_BASE_URL,
        'model': OPENAI_MODEL,
        'temperature': OPENAI_TEMPERATURE,
        'max_tokens': OPENAI_MAX_TOKENS
    }